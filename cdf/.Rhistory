install.packages("MAIT")
install.packages("~/Downloads/MAIT_0.16.tar.gz", repos = NULL, type = "source")
install.packages("CAMERA")
install.packages("CAMERA")
install.packages(c("randomForest", "ROCR", "gplots", "beanplot", "subselect",
"glmnet", "mclust", "pROC", "plyr", "MASS"), dep=TRUE)
source("http://www.bioconductor.org/biocLite.R")
biocLite(c("Biobase", "simpleaffy"), dep=TRUE)
library(MALDIquant)
install.packages("gplots", dep=TRUE)
install.packages("~/Downloads/ihm_1.0.5.tar.gz", repos = NULL, type = "source")
install.packages("~/Downloads/metadar_0.46.tar.gz", repos = NULL, type = "source")
library(metadar)
library(xcms)
install.packages("~/Downloads/faahKO_0.5.tar.gz", repos = NULL, type = "source")
install.packages("~/Downloads/faahKO_0.5.tgz", repos = NULL)
citation(faahKO)
citation("faahKO")
setwd("/Library/Frameworks/R.framework/Versions/3.0/Resources/library/faahKO/cdf")
xset<-xcmsSet()
xset
xset<-group(xset) #group peaks without visualization
xset<-group(xset, sleep = 0.001) #group peaks without visualization
?group
xset<-group(xset) #group peaks without visualization
retcor(xset)
xset<-xcmsSet() #import cdf files
group(xset)
detach("package:xcms", unload=TRUE)
source("http://bioconductor.org/biocLite.R")
biocLite("xcms", dep=T)
a
####### new figure with different axis labels
setwd("~/Dropbox/stoichiometry/R_inputs")
pdf(file='Figure2_030414.pdf', width=7, height=9)
#changes axis labeling
par(mfrow=c(3,2))
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#x and y axis labels and tics for plot A
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(0.8,1.2, 1.6, 2.0)
plot(total_per_P[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(total_per_P[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plota1, lwd=3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "P(%)", line = 2)
#text(33,1.95, labels=c("A"))
#x and y axis labels for plot B
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(60,80,100,120,140)
plot(C2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(C2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:P (molar)", line = 2)
#text(33,136, labels=c("E"))
#x and y axis labels for plot B
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(7,8,9,10,11)
plot(Total_per_N[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(6.9, 11.5), axes=F, cex=1.3)
abline(plotb1, lty=2)
points(Total_per_N[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotb2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N(%)", line = 2)
#text(33,11.35, labels=c("B"))
#x and y axis labels for plot D
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(3.9,4.2,4.5,4.8, 5.1)
plot(C2N_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, ylim=c(3.9, 5.1), xlim=c(30,170), axes=F, cex=1.3)
points(C2N_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:N (molar)", line = 2)
#text(33.0,5.05, labels=c("D"))
#x and y axis labels for plot C
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(32,35,38,41,44)
plot(Total_per_C[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(31,44), axes=F, cex=1.3)
abline(plotc1, lty=2)
points(Total_per_C[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotc2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C(%)", line = 2)
#text(33,43.5, labels=c("C"))
#x and y axis labels for plot F
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(10,15,20,25,30)
plot(N2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(N2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N:P (molar)", line = 2)
#text(33,30.5, labels=c("F"))
dev.off()
library(lmerTest)
library(nlme)
si4r2 <- read.csv("~/Dropbox/stoichiometry/R_inputs/si4r2.csv")
View(si4r2)
sto1<-si4r2
sto1$total_per_P_a<-asin(sqrt((sto1$total_per_P)/100))
sto1$Total_per_N_a<-asin(sqrt((sto1$Total_per_N)/100))
sto1$Total_per_C_a<-asin(sqrt((sto1$Total_per_C)/100))
#transform values with log
sto1$C2N_mol_l<-log(sto1$C2N_mol)
sto1$C2P_mol_l<-log(sto1$C2P_mol)
sto1$N2P_mol_l<-log(sto1$N2P_mol)
sto1$N15_l<-log(sto1$DeltaN15_vs_Air)
sto1$C15_l<-log(sto1$delta_C13_PDB)
sto1<-sto1[which(sto1$TL!="NA"),]
n9<-glm(N15_l~site_P_level+TL, data=sto1)
summary(n9)
n10<-glm(delta_C13_PDB~site_P_level, data=sto1)
summary(n10)
boxplot(n9$residuals~sto1$location) #can't have missing values to use this
summary(n10) #without log transforming N15 value
both1<-lme(total_per_P~TL+site_P_level, random=~1|location,data=sto1)
summary(both1)
both2<-lme(Total_per_N~TL+site_P_level, random=~1|location,data=sto1)
summary(both2)
both3<-lme(Total_per_C~TL+site_P_level, random=~1|location,data=sto1)
summary(both3)
both4<-lme(C2N_mol~TL+site_P_level, random=~1|location,data=sto1)
summary(both4)
both5<-lme(C2P_mol~TL+site_P_level, random=~1|location,data=sto1)
summary(both5)
both6<-lme(N2P_mol~TL+site_P_level, random=~1|location,data=sto1)
summary(both6)
plota<-glm(total_per_P~TL+site_P_level,data=sto1)
summary(plota)
plotb<-glm(Total_per_N~TL+site_P_level,data=sto1)
summary(plotb)
plotc<-glm(Total_per_C~TL+site_P_level,data=sto1)
summary(plotc)
plotd<-glm(C2N_mol~TL+site_P_level,data=sto1)
summary(plotd)
plote<-glm(C2P_mol~TL+site_P_level,data=sto1)
summary(plote)
plotf<-glm(N2P_mol~TL+site_P_level,data=sto1)
summary(plotf)
plota1<-glm(total_per_P~TL, data=sto1)
plotb1<-glm(Total_per_N[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"],data=sto1)
plotb2<-glm(Total_per_N[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"],data=sto1)
plotc1<-glm(Total_per_C[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"],data=sto1)
plotc2<-glm(Total_per_C[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"],data=sto1)
setwd("~/Dropbox/stoichiometry/R_inputs")
pdf(file='Figure2_030414.pdf', width=7, height=9)
#changes axis labeling
par(mfrow=c(3,2))
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#x and y axis labels and tics for plot A
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(0.8,1.2, 1.6, 2.0)
plot(total_per_P[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(total_per_P[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plota1, lwd=3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "P(%)", line = 2)
#text(33,1.95, labels=c("A"))
#x and y axis labels for plot B
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(60,80,100,120,140)
plot(C2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(C2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:P (molar)", line = 2)
#text(33,136, labels=c("E"))
#x and y axis labels for plot B
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(7,8,9,10,11)
plot(Total_per_N[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(6.9, 11.5), axes=F, cex=1.3)
abline(plotb1, lty=2)
points(Total_per_N[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotb2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N(%)", line = 2)
#text(33,11.35, labels=c("B"))
#x and y axis labels for plot D
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(3.9,4.2,4.5,4.8, 5.1)
plot(C2N_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, ylim=c(3.9, 5.1), xlim=c(30,170), axes=F, cex=1.3)
points(C2N_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:N (molar)", line = 2)
#text(33.0,5.05, labels=c("D"))
#x and y axis labels for plot C
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(32,35,38,41,44)
plot(Total_per_C[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(31,44), axes=F, cex=1.3)
abline(plotc1, lty=2)
points(Total_per_C[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotc2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C(%)", line = 2)
#text(33,43.5, labels=c("C"))
#x and y axis labels for plot F
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(10,15,20,25,30)
plot(N2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(N2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N:P (molar)", line = 2)
#text(33,30.5, labels=c("F"))
dev.off()
par(mfrow=c(3,2))
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#x and y axis labels and tics for plot A
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(0.8,1.2, 1.6, 2.0)
plot(total_per_P[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
abline(plota1, lwd=3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
lablistx<-c(40, 70, 100, 130, 160)
par(mfrow=c(3,2))
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#x and y axis labels and tics for plot A
lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(0.8,1.2, 1.6, 2.0)
plot(total_per_P[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
abline(plota1, lwd=3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "P(%)", line = 2)
#text(33,1.95, labels=c("A"))
#x and y axis labels for plot B
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(60,80,100,120,140)
plot(C2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(C2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:P (molar)", line = 2)
#text(33,136, labels=c("E"))
#x and y axis labels for plot B
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(7,8,9,10,11)
plot(Total_per_N[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(6.9, 11.5), axes=F, cex=1.3)
abline(plotb1, lty=2)
points(Total_per_N[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotb2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N(%)", line = 2)
#text(33,11.35, labels=c("B"))
#x and y axis labels for plot D
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(3.9,4.2,4.5,4.8, 5.1)
plot(C2N_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, ylim=c(3.9, 5.1), xlim=c(30,170), axes=F, cex=1.3)
points(C2N_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:N (molar)", line = 2)
#text(33.0,5.05, labels=c("D"))
#x and y axis labels for plot C
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(32,35,38,41,44)
plot(Total_per_C[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(31,44), axes=F, cex=1.3)
abline(plotc1, lty=2)
points(Total_per_C[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotc2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C(%)", line = 2)
#text(33,43.5, labels=c("C"))
#x and y axis labels for plot F
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(10,15,20,25,30)
plot(N2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(N2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N:P (molar)", line = 2)
#text(33,30.5, labels=c("F"))
dev.off()
setwd("~/Dropbox/stoichiometry/R_inputs")
pdf(file='Figure2_030414.pdf', width=7, height=9)
#changes axis labeling
par(mfrow=c(3,2))
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#x and y axis labels and tics for plot A
lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(0.8,1.2, 1.6, 2.0)
plot(total_per_P[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(total_per_P[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plota1, lwd=3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "P(%)", line = 2)
#text(33,1.95, labels=c("A"))
#x and y axis labels for plot B
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(60,80,100,120,140)
plot(C2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(C2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:P (molar)", line = 2)
#text(33,136, labels=c("E"))
#x and y axis labels for plot B
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(7,8,9,10,11)
plot(Total_per_N[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(6.9, 11.5), axes=F, cex=1.3)
abline(plotb1, lty=2)
points(Total_per_N[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotb2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N(%)", line = 2)
#text(33,11.35, labels=c("B"))
#x and y axis labels for plot D
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(3.9,4.2,4.5,4.8, 5.1)
plot(C2N_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, ylim=c(3.9, 5.1), xlim=c(30,170), axes=F, cex=1.3)
points(C2N_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C:N (molar)", line = 2)
#text(33.0,5.05, labels=c("D"))
#x and y axis labels for plot C
#lablistx<-c(40, 70, 100, 130, 160)
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
lablisty<-c(32,35,38,41,44)
plot(Total_per_C[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), ylim=c(31,44), axes=F, cex=1.3)
abline(plotc1, lty=2)
points(Total_per_C[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
abline(plotc2)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "C(%)", line = 2)
#text(33,43.5, labels=c("C"))
#x and y axis labels for plot F
par("mar"=c(1, 4, 1, 1)) #sets margin space, (bottom,left,top,right)
#lablistx<-c(40, 70, 100, 130, 160)
lablisty<-c(10,15,20,25,30)
plot(N2P_mol[sto1$site_P_level=="high"]~TL[sto1$site_P_level=="high"], data=sto1, ylab=NA, xlab=NA, xlim=c(30,170), axes=F, cex=1.3)
points(N2P_mol[sto1$site_P_level=="low"]~TL[sto1$site_P_level=="low"], data=sto1, pch=16, cex=1.3)
box()
axis(side =1, at=lablistx, tck = -0.03, labels=NA)
axis(side =2,  at=lablisty, tck = -0.03, las=1, labels=NA)
#axis(side = 1,  lwd = 0, line = -.4)
#axis(side = 1, at=lablistx, labels=lablistx, lwd = 0, line = -.4)
axis(side = 2, at=lablisty, labels=lablisty, lwd = 0, line = -.4, las = 1)
#mtext(side = 1, "TL (mm)", line = 2)
mtext(side = 2, "N:P (molar)", line = 2)
#text(33,30.5, labels=c("F"))
dev.off()
xset<-xcmsSet(method='centWave') #import cdf files
library(xcms)
setwd("/Library/Frameworks/R.framework/Versions/3.0/Resources/library/faahKO/cdf")
xset<-xcmsSet(method='centWave') #import cdf files
xset #check
xset1<-retcor(xset, method='obiwarp')
plottype=c('deviation')
xset2<-group(xset1, bw=5, minfrac=0.5, mzwid=0.025)
xset3<-fillPeaks(xset2)
dr<-diffreport(xset3, filebase='variationA_vs_controlA', eicmax=100)
dr
plot(dr)
plot(dr)
plot(xset2)
xset2
xset3
dr
plot(xset1)
xset1
?plotTIC
plotTIC(xset3)
plotTIC(xset)
plot(xset2)
?plotxcmsEIC
?plot.xcmsEIC
plot.xcmsEIC(dr)
peakPlots(xset1)
plotPeaks(xset1)
plotPeaks(xset2)
plotPeaks(xset3
)
plotPeaks(dr)
plotrt(xset1)
plotrt(xset1)
plotTIC(xset1)
plotTIC(xset2)
plotTIC(xset)
plotTIC(xset3)
plotTIC(dr)
